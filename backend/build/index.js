import dotenv from"dotenv";import axios from"axios";import express from"express";import{Server}from"socket.io";import{createServer}from"http";import"express-async-errors";import bodyParser from"body-parser";dotenv.config({path:`${new URL(`../.env.${process.env.NODE_ENV}`,import.meta.url).pathname}`});const PORT_EXPRESS=process.env.PORT_EXPRESS||5e3;axios.defaults.headers["Content-Type"]="application/json";const app=express(),server=createServer(app),io=new Server(server),sockets={};io.on("connection",(async e=>{sockets[id]=e.id,e.on("disconnect",(r=>{delete sockets[e.id]}))})),app.use(bodyParser.urlencoded({extended:!1})),app.use(bodyParser.json()),app.use((async(e,r,o,s)=>(console.error(e),o.status(500).json({error:e.stack})))),server.listen(PORT_EXPRESS),console.log(`Server now listening on port ${PORT_EXPRESS}`);